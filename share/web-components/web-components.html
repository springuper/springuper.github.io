<!DOCTYPE html><html>  <head>    <title>Web Components</title>    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>    <script src="https://github.com/downloads/gnab/remark/remark-0.4.2.min.js" type="text/javascript">      {"highlightStyle": "monokai",       "highlightLanguage": "javascript" }    </script>    <style type="text/css" media="screen">      @import url(http://fonts.googleapis.com/css?family=Ubuntu:400,500);      @import url(http://fonts.googleapis.com/css?family=Yanone+Kaffeesatz);      body {         font-family: 'Ubuntu';        font-weight: 400;      }      h1, h2, h3 {        font-family: 'Yanone Kaffeesatz';        font-weight: 400;        margin: 5px;      }      h1 { font-size: 4em; }      h2 { font-size: 2.3em; }      h3 { font-size: 1.6em; }      body { font-size: 1.5em; }      .slide .content {        padding: 10px 90px !important;      }      #slideshow .no-highlight {        font-size: 1em !important;      }      #slideshow .slide .content pre {        text-align: left;      }      #slideshow .slide .content pre .javascript {          opacity: 1;      }      blockquote {        font-style: italic;        margin: 0.25em 0;        padding: 0.25em 40px;        line-height: 1.45;        position: relative;      }      code {        -moz-border-radius: 5px;        -web-border-radius: 5px;        background: #e7e8e2;        border-radius: 5px;      }      .inverse {        background: #A60A17;      }    </style>  </head>  <body>    <textarea id="source">name: inverseclass: center, middlelayout: true---# Web Components### 尚春@美团---## 还记得大明湖畔的 `<select>` 吗？---```html<select size=3>    <option>meituan</option>    <option selected>tencent</option>    <option disabled>alibaba</option></select>```<select size=3>    <option>meituan</option>    <option selected>tencent</option>    <option disabled>alibaba</option></select>--```javascriptvar el = document.querySelector('select');el.addEventListener('change', function (e) {    // do sth});el.selectedIndex = 1;```--这货有自己的视觉、交互、事件和API，不简单啊~---## 声明式 declarative## 封装 encapsulated## 表意 meaningful---## 这给我们什么启示呢？--What if HTML was **expressive** enough to allow us to create our own tags?---# Web Components## Template## Custom Element## Shadow DOM## Imports---layout: falsetemplate: inverse# Template```html<template id="commentTemplate">    <div>        <img src="">        <div class="comment-text"></div>    </div></template><script>function addComment(imageUrl, text) {    var t = document.querySelector("#commentTemplate");    var comment = t.content.cloneNode(true);    // Populate content.    comment.querySelector('img').src = imageUrl;    comment.querySelector('.comment-text').textContent = text;    document.body.appendChild(comment);}</script>```---### 解析，不处理（资源和脚本）### 内部节点不可被外部访问---# Shadow DOM---```html<h2 class="normal-title">Normal Title</h2><script>    var ref = document.querySelector('.normal-title');    var host = document.createElement('div');    var shadowRoot = host.createShadowRoot();    shadowRoot.innerHTML = '<h2 style="color:red">Shadow Title</h2>';    ref.parentNode.insertBefore(host, ref);</script>```<h2 class="normal-title">Normal Title</h2>---![shadow dom](shadow-dom.png)---## 封装内部实现## 隔离样式-- 提供类似浏览器原生组件的实现机制--有那么一点像 `<iframe>`，但显然更轻量---# Custom Element```html<element name="tick-tock-clock">    <script>        ({            bar: {                get: function() { return 5; }            },            foo: {                value: function() {                    alert('foo() called');                }            }        });    </script></element>```--声明式，很好很强大--但是，由于实现问题，暂时被雪藏---## 真正可以用的是```jsvar XFoo = document.registerElement('x-foo', {    prototype: Object.create(HTMLElement.prototype, {        bar: {            get: function() { return 5; }        },        foo: {            value: function() {                alert('foo() called');            }        }    })});var xfoo = document.createElement('x-foo');document.body.appendChild(xfoo);```---## 生命周期方法```javascriptvar XFooProto = Object.create(HTMLElement.prototype);// called when an instance of the element is createdXFooProto.createdCallback = function() {    this.innerHTML = "<b>I'm an x-foo-with-markup!</b>";};var XFoo = document.registerElement('x-foo-with-markup', {    prototype: XFooProto});var xfoo = document.createElement('x-foo-with-markup');document.body.appendChild(xfoo);```--### createdCallback### attachedCallback### detachedCallback### attributeChangedCallback---## 结合Template & Shadow DOM```html<template id="sdtemplate">    <style>        p { color: orange; }    </style>    <p>I'm in Shadow DOM. My markup was stamped from a &lt;template&gt;.</p></template><script>var proto = Object.create(HTMLElement.prototype, {    createdCallback: {        value: function() {            var t = document.querySelector('#sdtemplate');            var clone = document.importNode(t.content, true);            this.createShadowRoot().appendChild(clone);        }    }});document.registerElement('x-foo-from-template', { prototype: proto });var xfoo = document.createElement('x-foo-from-template');document.body.appendChild(xfoo);</script>```<template id="sdtemplate">    <style>        p { color: orange; }    </style>    <p>I'm in Shadow DOM. My markup was stamped from a &amp;lt;template&amp;gt;.</p></template>---# Imports### x-foo-from-template.html```html<template id="sdtemplate">    ...</template><script>var proto = Object.create(HTMLElement.prototype, {    createdCallback: {...});document.registerElement('x-foo-from-template', { prototype: proto });</script>```### index.html```html<link rel="import" href="x-foo-from-template" /><x-foo-from-template></x-foo-from-template>```---# Polymer![Polymer](polymer-logo.svg)puts elements back at the center of web development---## elements/color-picker.html```html<link rel="import" href="bower_components/polymer/polymer.html"><polymer-element name="color-picker" attributes="owner color">    <template>        <p>            This is a <strong>{{owner}}</strong>'s editable-color-picker.            He likes the color <b style="color: {{color}}">{{color}}</b>.        </p>        <button on-click="{{setFocus}}">Set focus to text input</button>        <input id="nameInput" value="{{owner}}" placeholder="Your name">    </template>    <script>        Polymer('color-picker', {        color: "red",        owner: "Daniel",        setFocus: function() {            this.$.nameInput.focus();        }        });    </script></polymer-element>```---## index.html```html<!DOCTYPE html><html>    <head>        <script src="bower_components/platform/platform.js"></script>        <link rel="import" href="color-picker.html">    </head>    <body>        <color-picker owner="Scott" color="blue"></color-picker>    </body></html>```---## 参考### [Introduction to Web Components](http://www.w3.org/TR/components-intro/)### [Custom Elements](http://www.html5rocks.com/en/tutorials/webcomponents/customelements/)### [Polymer Project](http://www.polymer-project.org/)### [Web Components by Nikolaus Graf](https://speakerdeck.com/nikgraf/web-components)### [LondonJS: Web Components Can Do That?! by Addy Osmani](https://speakerdeck.com/addyosmani/londonjs-web-components-can-do-that)    </textarea>    <div id="slideshow"></div>  </body></html>